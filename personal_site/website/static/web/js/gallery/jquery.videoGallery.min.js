(function(e){function n(a,c){function x(a){if(b._componentInited&&!b._playlistTransitionOn&&!b.volumebarDown){if(!b.seekBarDown){if(m){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();b.seekBarDown=!0;b._doc.bind(p,function(a){a:{var b;if(m){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a; b=b[0]}else b=a;a.preventDefault();f(b.pageX)}});b._doc.bind(q,function(a){a:if(b.seekBarDown){b.seekBarDown=!1;b._doc.unbind(p).unbind(q);var c;if(m){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();f(c.pageX)}})}return!1}}function f(a){a-=b.progress_bg.offset().left;0>a?a=0:a>b.seekBarSize&& (a=b.seekBarSize);b.progress_level.width(a);a=Math.max(0,Math.min(1,a/b.seekBarSize));if(b.html5Support){a=(a*b.videoUp2Js.duration).toFixed(1);try{b.videoUp2Js.currentTime=a}catch(c){}}}function l(){b.videoInited&&(b.player_progress_tooltip.css("display","block"),b.player_progress.bind("mousemove",g).bind("mouseout",h),b._doc.bind("mouseout",h))}function h(){b.videoInited&&(b.player_progress_tooltip.css("display","none"),b.player_progress.unbind("mousemove",g).unbind("mouseout",h),b._doc.unbind("mouseout", h))}function g(a){a=a.pageX-b.player_progress.offset().left;0>a?a=0:a>b.seekBarSize&&(a=b.seekBarSize);var c=a+parseInt(b.player_progress.css("left"),10)-b.player_progress_tooltip.width()/2;b.player_progress_tooltip.css("left",c+"px");a=Math.max(0,Math.min(1,a/b.seekBarSize));b.html5Support&&(a*=b.videoUp2Js.duration,b.player_progress_tooltip_value.html(b.formatCurrentTime(a)+b.formatDuration(b.videoUp2Js.duration)));a=b.player_progress_tooltip.width()/2-b.player_progress_tooltip_value.width()/2; b.player_progress_tooltip_value.css("left",a+"px")}function y(a){if(b._componentInited&&!b._playlistTransitionOn&&!b.seekBarDown){if(!b.volumebarDown){if(m){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();b.volumebarDown=!0;b._doc.bind(p,function(a){a:{var b;if(m){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a; if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();r(b.pageX)}});b._doc.bind(q,function(a){a:if(b.volumebarDown){b.volumebarDown=!1;b._doc.unbind(p).unbind(q);var c;if(m){if(a.originalEvent.touches&&a.originalEvent.touches.length)c=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)c=a.originalEvent.changedTouches;else break a;if(1<c.length)break a;c=c[0]}else c=a;a.preventDefault();r(c.pageX);0==b.defaultVolume?(b.player_volume.find("img").attr("src", b.ic_mute),b.videoUp2Js.muted=!0):0<b.defaultVolume&&(b.player_volume.find("img").attr("src",b.ic_volume),b.videoUp2Js.muted=!1)}})}return!1}}function r(a){b.defaultVolume=Math.max(0,Math.min(1,(a-b.volume_bg.offset().left)/b.volumeSize));b._setVolume()}function n(){b.videoInited&&(b.player_volume_tooltip.css("display","block"),b.volume_seekbar.bind("mousemove",v).bind("mouseout",u),b._doc.bind("mouseout",u))}function u(){b.videoInited&&(b.player_volume_tooltip.css("display","none"),b.volume_seekbar.unbind("mousemove", v).unbind("mouseout",u),b._doc.unbind("mouseout",u))}function v(a){a=a.pageX-b.volume_bg.offset().left;0>a?a=0:a>b.volumeSize&&(a=b.volumeSize);var c=parseInt(b.playerControls.css("width"),10)+a-parseInt(b.volume_seekbar.css("right"),10)-parseInt(b.volume_seekbar.css("width"),10)+parseInt(b.volume_bg.css("left"),10)-b.player_volume_tooltip.width()/2;b.player_volume_tooltip.css("left",c+"px");a=Math.max(0,Math.min(1,a/b.volumeSize));a=parseInt(100*a,10);b.player_volume_tooltip_value.html(a+" %");a= b.player_volume_tooltip.width()/2-b.player_volume_tooltip_value.width()/2;b.player_volume_tooltip_value.css("left",a+"px")}function w(){b.componentWrapper.css({display:"none",opacity:1});b.html5Support||b.flashPreviewHolder.css({opacity:1});b._componentInited||(b._componentInited=!0,b.settings.videoGallerySetupDone.call(b))}var b=this;this.settings=e.extend({},e.fn.videoGallery.defaults,c);this.useRollovers=(this.isMobile=isMobile)?!1:!0;this.isIE=isIE;this.ieBelow9=ieBelow9;this.isSafari=isSafari; this.ic_volume="media/data/video_icons/volume.png";this.ic_volume_on="media/data/video_icons/volume_on.png";this.ic_mute="media/data/video_icons/mute.png";this.ic_mute_on="media/data/video_icons/mute_on.png";this.ic_pause="media/data/video_icons/pause.png";this.ic_pause_on="media/data/video_icons/pause_on.png";this.ic_play="media/data/video_icons/play.png";this.ic_play_on="media/data/video_icons/play_on.png";this.ic_fullscreen_enter="media/data/video_icons/fullscreen_enter.png";this.ic_fullscreen_enter_on= "media/data/video_icons/fullscreen_enter_on.png";this.ic_fullscreen_exit="media/data/video_icons/fullscreen_exit.png";this.ic_fullscreen_exit_on="media/data/video_icons/fullscreen_exit_on.png";this.ic_player_prev="media/data/video_icons/v_prev.png";this.ic_player_prev_on="media/data/video_icons/v_prev_on.png";this.ic_player_next="media/data/video_icons/v_next.png";this.ic_player_next_on="media/data/video_icons/v_next_on.png";this.ic_w_play="media/data/video_icons/w_play.png";this.ic_w_pause="media/data/video_icons/w_pause.png"; this.ic_close="media/data/video_icons/close.png";this.ic_close_on="media/data/video_icons/close_on.png";this._componentInited=!1;this._body=e("body");this.bodyOverflowOrig=this._body.css("overflow");this._window=e(window);this._doc=e(document);this._windowResizeInterval=200;this._windowResizeIntervalID;this._mediaPath;this._mediaType;this._vimeoPlayer;this._youtubePlayer;this._youtubeChromeless=this._youtubeInited=this._vimeoInited=!1;this.mg_gallery=this.settings.mg_gallery;this.mg_settings=this.settings.mg_settings; this.mg_wrapper=this.settings.wrapper;this.wrapperOverflowOrig=this.mg_wrapper.css("overflow");this.includeVideoInSlideshow=this.mg_settings.includeVideoInSlideshow;this.flashPreview=this.mg_settings.flashHolder;this.initialAutoplay=this.vim_autoPlay=this.yt_autoPlay=this.autoPlay=this.mg_settings.videoAutoPlay;this.videoLoop=this.mg_settings.videoLoop;this.defaultVolume=this.mg_settings.videoVolume;0>this.defaultVolume?this.defaultVolume=0:1<this.defaultVolume&&(this.defaultVolume=1);this.useYoutubeHighestQuality= this.mg_settings.useYoutubeHighestQuality;this.componentWrapper=e(a);this.mediaPreloader=this.componentWrapper.find(".mediaPreloader").css("display","none");this.origPlayerSizeSet=!1;this.origPlayerW;this.origPlayerH;this.player_close=e(".player_close").css("cursor","pointer").bind("click",function(){b.mg_gallery.closePlayer();return!1});b.useRollovers&&this.player_close.bind("mouseenter",function(){b.player_close.children("img").attr("src",b.ic_close_on);return!1}).bind("mouseleave",function(){b.player_close.children("img").attr("src", b.ic_close);return!1});this.playerRatio=this.componentWrapper.width()/this.componentWrapper.height();this.mediaHolder=this.componentWrapper.find(".mediaHolder").bind("click",function(){b.togglePlayBack();return!1});this.youtubeHolder=this.componentWrapper.find(".youtubeHolder");this.youtubeWrapper=this.componentWrapper.find(".youtubeWrapper");this._hideYT();this.vimeoHolder=this.componentWrapper.find(".vimeoHolder");this.flashPreviewHolder=this.componentWrapper.find(".flashPreviewHolder");this._componentWidth= this._getComponentSize("w");this._componentHeight=this._getComponentSize("h");this.playerControls=this.componentWrapper.find(".playerControls");this.playerControlsOrigL=parseInt(this.playerControls.css("left"),10);this.player_mediaTime=this.componentWrapper.find(".player_mediaTime");this.isIOS=!1;var k=navigator.userAgent;if(-1<k.indexOf("iPhone")||-1<k.indexOf("iPod")||-1<k.indexOf("iPad"))this.isIOS=!0,this.aspectRatio=1;(this.isiPhoneIpod=-1<k.indexOf("iPhone")||-1<k.indexOf("iPod"))&&this.componentWrapper.find(".playerControls").remove(); this.isAndroid=-1<k.indexOf("Android");this.isMobile&&(this.vim_autoPlay=this.yt_autoPlay=this.autoPlay=!1);this.vorbisSupport=this.canPlayVorbis();this.mp4Support=this.canPlayMP4();this.webMsupport=this.canPlayWebM();this.html5Support=!!document.createElement("video").canPlayType;this.fullscreenCount=0;this.fullscreenPossible=!1;this.checkFullScreenSupport()&&(this.fullscreenPossible=!0);if(this.fullscreenPossible)this._doc.on("fullscreenchange mozfullscreenchange webkitfullscreenchange",function(){b.setFullscreenIcon(); "fullscreen"==b.componentSize&&0<b.fullscreenCount&&(b.componentSize="normal",b.resizeComponent());b.fullscreenCount=1});this.html5video_inited=!1;this.previewPoster;this.bigPlay;this.html5Support&&(this.bigPlay=this.componentWrapper.find(".bigPlay").css("cursor","pointer").bind("click",function(){b.togglePlayBack();return!1}));if(this.autoHideControls=this.isMobile?!1:!0)this.componentHit=!1,this.componentWrapper.mouseenter(function(a){componentHit=!0;b.showControls()}).mouseleave(function(){componentHit= !1;b.hideControls()});this.aspectRatio=1;this.videoInited=!1;this._mediaPath;this.mediaPlaying=!1;this.flashReadyInterval=100;this.flashReadyIntervalID;this.flashCheckDone=!1;this.dataInterval=100;this.dataIntervalID;this.mediaWidth;this.mediaHeight;this.componentSize="normal";this.video;this.videoUp2Js;this.mediaPreview=this.componentWrapper.find(".mediaPreview").bind("click",function(){b.togglePlayBack();return!1});var p=k="",q="",m;"ontouchstart"in window?(m=!0,k="touchstart.ap",p="touchmove.ap", q="touchend.ap"):(m=!1,k="mousedown.ap",p="mousemove.ap",q="mouseup.ap");this.seekPercent;this.seekBarDown=!1;this.player_progress=this.componentWrapper.find(".player_progress");this.progress_bg=this.componentWrapper.find(".progress_bg");this.load_level=this.componentWrapper.find(".load_level");this.progress_level=this.componentWrapper.find(".progress_level");this.controlsMediaWidthDiff=20;this.controlsSeekbarDiff=280;this.seekBarSize=this.playerControls.width()-this.controlsSeekbarDiff;this.player_progress.css("cursor", "pointer").bind(k,function(a){x(a);return!1});this.player_progress_tooltip=this.componentWrapper.find(".player_progress_tooltip").css("left",parseInt(this.player_progress.css("left"),10)+"px");this.player_progress_tooltip_value=this.componentWrapper.find(".player_progress_tooltip_value");this.isMobile||this.player_progress.bind("mouseover",l);this.player_volume=this.componentWrapper.find(".vplayer_volume");this._lastVolume=this.defaultVolume;this.volumebarDown=!1;this.volume_seekbar=this.componentWrapper.find(".volume_seekbar"); this.volume_bg=this.componentWrapper.find(".volume_bg");this.volume_level=this.componentWrapper.find(".volume_level");this.volumeSize=this.volume_bg.width();this.volume_level.css("width",this.defaultVolume*this.volumeSize+"px");0==this.defaultVolume?(this._lastVolume=.5,this.player_volume.find("img").attr("src",this.ic_mute)):0<this.defaultVolume&&this.player_volume.find("img").attr("src",this.ic_volume);this.volume_seekbar.css("cursor","pointer").bind(k,function(a){y(a);return!1});this.player_volume_tooltip= this.componentWrapper.find(".player_volume_tooltip").css("left",parseInt(this.volume_seekbar.css("left"),10)+"px");this.player_volume_tooltip_value=this.componentWrapper.find(".player_volume_tooltip_value");this.isMobile||this.volume_seekbar.bind("mouseover",n);this.html5Support||(this.mediaPreview.remove(),this.mp4Support=!0);this.player_playControl=this.componentWrapper.find(".player_playControl").css("cursor","pointer").bind("click",function(){b.togglePlayBack();return!1});b.useRollovers&&this.player_playControl.bind("mouseover", function(){b.mediaPlaying?b.componentWrapper.find(".player_playControl").find("img").attr("src",b.ic_pause_on):b.componentWrapper.find(".player_playControl").find("img").attr("src",b.ic_play_on);return!1}).bind("mouseout",function(){b.mediaPlaying?b.componentWrapper.find(".player_playControl").find("img").attr("src",b.ic_pause):b.componentWrapper.find(".player_playControl").find("img").attr("src",b.ic_play);return!1});this.player_volume.css("cursor","pointer").bind("click",function(){0==b.defaultVolume? (b.defaultVolume=b._lastVolume,b.html5Support&&(b.videoUp2Js.muted=!1),b._setVolume(),b.player_volume.find("img").attr("src",b.ic_volume)):(b._lastVolume=b.defaultVolume,b.html5Support&&(b.videoUp2Js.muted=!0),b.defaultVolume=0,b._setVolume(),b.player_volume.find("img").attr("src",b.ic_mute));return!1});b.useRollovers&&this.player_volume.bind("mouseover",function(){0==b.defaultVolume?b.player_volume.find("img").attr("src",b.ic_mute_on):b.player_volume.find("img").attr("src",b.ic_volume_on);return!1}).bind("mouseout", function(){0==b.defaultVolume?b.player_volume.find("img").attr("src",b.ic_mute):b.player_volume.find("img").attr("src",b.ic_volume);return!1});this.player_fullscreen=this.componentWrapper.find(".player_fullscreen").css("cursor","pointer").bind("click",function(){b.toggleFullscreen(!0);return!1});b.useRollovers&&this.player_fullscreen.bind("mouseover",function(){"normal"==b.componentSize?b.player_fullscreen.find("img").attr("src",b.ic_fullscreen_enter_on):b.player_fullscreen.find("img").attr("src", b.ic_fullscreen_exit_on);return!1}).bind("mouseout",function(){"normal"==b.componentSize?b.player_fullscreen.find("img").attr("src",b.ic_fullscreen_enter):b.player_fullscreen.find("img").attr("src",b.ic_fullscreen_exit);return!1});this._window.bind("resize",function(){if(!b._componentInited)return!1;b._windowResizeIntervalID&&clearInterval(b._windowResizeIntervalID);b._windowResizeIntervalID=setTimeout(function(){b._doneResizing()},b._windowResizeInterval);return!1});this._doneResizing();this.html5Support? (this.flashPreviewHolder.remove(),w()):(this.flashPreviewHolder.css("display","block"),this.flashReadyIntervalID=setInterval(function(){void 0!=b.getFlashMovie(b.flashPreview).setData&&(b.flashReadyIntervalID&&clearInterval(b.flashReadyIntervalID),b.getFlashMovie(b.flashPreview).setData(b.mg_settings,b.seekBarSize,b.volumeSize,b.controlsMediaWidthDiff,b.isMobile,b.initialAutoplay),w())},this.flashReadyInterval))}n.prototype={playMedia:function(){if(!this._componentInited||this._playlistTransitionOn|| !this._mediaType)return!1;"local"==this._mediaType?this.togglePlayBack():"vimeo"==this._mediaType?this._vimeoPlayer&&this._vimeoPlayer.play():"youtube"==this._mediaType&&this._youtubePlayer&&this._youtubePlayer.play();this.mediaPlaying=!0},pauseMedia:function(){if(!this._componentInited||this._playlistTransitionOn||!this._mediaType)return!1;"local"==this._mediaType?this.togglePlayBack():"vimeo"==this._mediaType?this._vimeoPlayer&&this._vimeoPlayer.pause():"youtube"==this._mediaType&&this._youtubePlayer&& this._youtubePlayer.pause();this.mediaPlaying=!1},setVolume:function(a){if(!this._componentInited||this._playlistTransitionOn||!this._mediaType)return!1;0>a?a=0:1<a&&(a=1);this.defaultVolume=a;this._setVolume()},loadPreview:function(a){var c=this;this.mediaPreview.css("display","block");this.mediaPreloader&&this.mediaPreloader.css("display","block");this.previewPoster=e(new Image).css({position:"absolute",display:"block",opacity:0}).appendTo(this.mediaPreview).load(function(){c._resizeControls(); c.mediaPreloader&&c.mediaPreloader.css("display","none");c.resizePreview();c.previewPoster.animate({opacity:1},{duration:500,easing:"easeOutSine"});c.bigPlay&&c.bigPlay.css("display","block")}).attr("src",a).error(function(a){})},togglePlayBack:function(){var a=this;this.videoInited||this.autoPlay?this.html5Support?this.videoUp2Js.paused?this.videoUp2Js.play():this.videoUp2Js.pause():"undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_togglePlayback&& this.getFlashMovie(this.flashPreview).pb_togglePlayback():(this.previewPoster&&this.previewPoster.stop().animate({opacity:0},{duration:500,easing:"easeOutSine",complete:function(){a.previewPoster.remove();a.previewPoster=null}}),this.html5Support?this._initLocal():("undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_play&&this.getFlashMovie(this.flashPreview).pb_play(this._mediaPath,this.aspectRatio),this._resizeControls()));this.videoInited= !0;return!1},flashResizeControls:function(){this._resizeControls()},flashMainPreviewOff:function(){"undefined"!==typeof this.getFlashMovie(this.flashPreview)&&("undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_play&&this.getFlashMovie(this.flashPreview).pb_play(this._mediaPath,this.aspectRatio),this.videoInited=!0)},flashVideoPause:function(){this.mediaPlaying=!1},flashVideoResume:function(){this.mediaPlaying=!0},flashVideoEnd:function(){this._mediaAdvance()},flashVideoStart:function(){this.videoInited= !0;this.showControls()},dataUpdateFlash:function(a,c,e,f){},getFlashMovie:function(a){"#"==a.charAt(0)&&(a=a.substr(1));return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]},showControls:function(){this.videoInited&&(this.html5Support?this.playerControls.css("display","block"):"undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_toggleControls&&this.getFlashMovie(this.flashPreview).pb_toggleControls(!0))},hideControls:function(){this.html5Support? this.playerControls.css("display","none"):this.mg_gallery.videoPlayerHolderState()&&"undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_toggleControls&&this.getFlashMovie(this.flashPreview).pb_toggleControls(!1)},resizeComponent:function(){"local"==this._mediaType&&this.html5Support&&this.playerControls.css("left","10000px");"fullscreen"==this.componentSize?(this._body.css("overflow","hidden"),this.mg_wrapper.css("overflow","visible"), this.componentWrapper.removeClass("videoPlayer").addClass("videoPlayer_fs"),this.player_close.css("display","none")):(this._body.css("overflow",this.bodyOverflowOrig),this.mg_wrapper.css("overflow",this.wrapperOverflowOrig),this.componentWrapper.removeClass("videoPlayer_fs").addClass("videoPlayer"),this.player_close.css("display","block"));"local"==this._mediaType&&(this.previewPoster&&this.resizePreview(),this.html5Support&&this.videoInited&&(this.resizeVideo(),this._resizeControls(),this.playerControls.css("left", this.playerControlsOrigL+"px")))},resizePreview:function(){if(this.previewPoster){var a,c,e,f=this.previewPoster;0!=this.aspectRatio&&(1==this.aspectRatio?a=this.retrieveObjectRatio(!0,f):2==this.aspectRatio&&(a=this.retrieveObjectRatio(!1,f)));"normal"==this.componentSize?(c=(this._getPlayerSize("w")-a.width)/2,e=(this._getPlayerSize("h")-a.height)/2):(c=(this._getComponentSize("w")-a.width)/2,e=(this._getComponentSize("h")-a.height)/2);f.css({width:a.width+"px",height:a.height+"px",left:c+"px", top:e+"px"})}},resizeVideo:function(){if(this.video){var a,c,e;0==this.aspectRatio?a=this.getMediaSize():1==this.aspectRatio?a=this.retrieveObjectRatio(!0):2==this.aspectRatio&&(a=this.retrieveObjectRatio(!1));"normal"==this.componentSize?(c=(this._getPlayerSize("w")-a.width)/2,e=(this._getPlayerSize("h")-a.height)/2):(c=(this._getComponentSize("w")-a.width)/2,e=(this._getComponentSize("h")-a.height)/2);this.video.css({width:a.width+"px",height:a.height+"px",left:c+"px",top:e+"px"})}},retrieveObjectRatio:function(a, c){if("normal"==this.componentSize)var e=this._getPlayerSize("w"),f=this._getPlayerSize("h");else e=this._getComponentSize("w"),f=this._getComponentSize("h");var l,h,g={};c?(l=c.width(),h=c.height()):(c=this.getMediaSize(),l=c.width,h=c.height);var n=(e-0)/(f-0),r=l/h;r<n?a?(g.width=(f-0)/h*l,g.height=f-0):(g.height=(e-0)/l*h,g.width=e-0):r>n?a?(g.height=(e-0)/l*h,g.width=e-0):(g.width=(f-0)/h*l,g.height=f-0):(g.width=e-0,g.height=f-0);return g},getMediaSize:function(){var a={};this.videoUp2Js?(a.width= this.videoUp2Js.videoWidth,a.height=this.videoUp2Js.videoHeight):(a.width=this._getPlayerSize("w"),a.height=this._getPlayerSize("h"));return a},resetData:function(){this.player_mediaTime.html("00:00 | 00:00");this.progress_level.css("width","0px");this.load_level.css("width","0px")},canPlayVorbis:function(){var a=document.createElement("video");return!(!a.canPlayType||!a.canPlayType('video/ogg; codecs="theora, vorbis"').replace(/no/,""))},canPlayMP4:function(){var a=document.createElement("video"); return!(!a.canPlayType||!a.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"').replace(/no/,""))},canPlayWebM:function(){var a=document.createElement("video");return!(!a.canPlayType||!a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/no/,""))},formatCurrentTime:function(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)},formatDuration:function(a){a=Math.round(a);minutes=Math.floor(a/60);minutes= 10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return" | "+minutes+":"+(10<=a?a:"0"+a)},setFullscreenIcon:function(){document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?this.player_fullscreen.children("img").attr("src",this.ic_fullscreen_enter):this.player_fullscreen.children("img").attr("src",this.ic_fullscreen_exit)},fullScreenStatus:function(){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen},toggleFullscreen:function(a){if(this.fullScreenStatus())this.fullscreenPossible? (this.componentSize="normal"==this.componentSize&&a?"fullscreen":"normal",this.resizeComponent()):this._doneResizing();else{this.fullscreenCount=0;"normal"==this.componentSize?(this.componentSize="fullscreen",this.fullscreenPossible||this.componentWrapper.find(".player_fullscreen").find("img").attr("src",this.ic_fullscreen_exit)):(this.componentSize="normal",this.fullscreenPossible||this.componentWrapper.find(".player_fullscreen").find("img").attr("src",this.ic_fullscreen_enter));if(this.fullscreenPossible|| this.html5Support)document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen():document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen? document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();this.fullscreenPossible?"normal"==this.componentSize&&a&&this.resizeComponent():this._doneResizing()}},checkFullScreenSupport:function(){var a=!1;document.documentElement.requestFullScreen?a=!0:document.documentElement.mozRequestFullScreen?a=!0:document.documentElement.webkitRequestFullScreen&&(a=!0);return a},_findMedia:function(a,c){this._cleanMedia();this._mediaType=a;if("local"==this._mediaType){var e= c.preview;this.mp4Support?this._mediaPath=c.mp4:this.vorbisSupport?this._mediaPath=c.ogv:this.webmSupport&&(this._mediaPath=c.webm);this.autoPlay?this.html5Support?(this._resizeControls(),this._initLocal()):("undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_play&&this.getFlashMovie(this.flashPreview).pb_play(this._mediaPath,this.aspectRatio),this._resizeControls(),this.videoInited=!0):this.html5Support?this.loadPreview(e):"undefined"!== typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_loadPreview&&this.getFlashMovie(this.flashPreview).pb_loadPreview(e)}else"vimeo"==this._mediaType?(this._mediaPath=c,this._initVimeo()):"youtube"==this._mediaType?(this._mediaPath=c,this._initYoutube()):alert("Wrong data-type in playlist!")},_cleanMedia:function(){if("local"==this._mediaType){this.mediaPreview.css("display","none");this.hideControls();if(this.html5Support){if(this.videoUp2Js){this.videoUp2Js.pause(); try{this.videoUp2Js.currentTime=0}catch(a){}this.videoUp2Js.src=""}this.video&&this.video.unbind("ended loadedmetadata waiting playing play pause");this.mediaHolder.css("display","none");!this.isMobile&this.html5Support&&(this.mediaHolder.html(""),this.html5video_inited=!1)}else"undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_dispose&&this.getFlashMovie(this.flashPreview).pb_dispose();this.bigPlay&&this.bigPlay.css("display", "none");this.mediaPreloader&&this.mediaPreloader.css("display","none");this.previewPoster&&(this.previewPoster.remove(),this.previewPoster=null);this.resetData();this.videoInited=this.mediaPlaying=!1}else"vimeo"==this._mediaType?this._vimeoPlayer&&this._vimeoPlayer.clean():"youtube"==this._mediaType&&(this._youtubePlayer&&this._youtubePlayer.stop(),this._hideYT())},_setVolume:function(){"local"==this._mediaType?(this.volume_level.width(this.defaultVolume*this.volumeSize),this.html5Support?this.videoUp2Js.volume= this.defaultVolume:"undefined"!==typeof this.getFlashMovie(this.flashPreview)&&"undefined"!==typeof this.getFlashMovie(this.flashPreview).pb_setVolume&&this.getFlashMovie(this.flashPreview).pb_setVolume(this.defaultVolume)):"vimeo"==this._mediaType?this._vimeoPlayer&&this._vimeoPlayer.setVolume(this.defaultVolume):"youtube"==this._mediaType&&this._youtubePlayer&&this._youtubePlayer.setVolume(this.defaultVolume)},_initLocal:function(){var a=this;if(this.html5video_inited)this.mediaHolder.css("display", "block"),this.videoUp2Js.src=this._mediaPath,this.videoUp2Js.load();else{var c="";this.mp4Support?(this.isAndroid?c=c+'<video class="video_cont" width="100%" height="100%" >'+('<source src="'+this._mediaPath+'" />'):(c+='<video class="video_cont" width="100%" height="100%" >',c+='<source src="'+this._mediaPath+'" type="video/mp4" />'),c+="</video>"):this.vorbisSupport?(this.isAndroid?(c+='<video class="video_cont" width="100%" height="100%" >',c+='<source src="'+this._mediaPath+'" />'):(c+='<video class="video_cont" width="100%" height="100%" >', c+='<source src="'+this._mediaPath+'" type="video/ogg" />'),c+="</video>"):this.webMsupport&&(this.isAndroid?(c+='<video class="video_cont" width="100%" height="100%" >',c+='<source src="'+this._mediaPath+'" />'):(c+='<video class="video_cont" width="100%" height="100%" >',c+='<source src="'+this._mediaPath+'" type="video/webm" />'),c+="</video>");this.mediaHolder.css("display","block").html(c);this.video=this.mediaHolder.find(".video_cont");this.videoUp2Js=this.video[0]}this.videoUp2Js.volume= this.defaultVolume;this.video.css("position","absolute").bind("ended",function(){if(a.mg_gallery.getSlideshowForcePause())if(a.includeVideoInSlideshow)a.mg_gallery.videoEnd();else{try{a.videoUp2Js.currentTime=0}catch(c){}a.videoLoop?a.videoUp2Js.paused&&a.videoUp2Js.play():a.videoUp2Js.pause()}else{try{a.videoUp2Js.currentTime=0}catch(e){}a.videoLoop?a.videoUp2Js.paused&&a.videoUp2Js.play():a.videoUp2Js.pause()}}).bind("loadedmetadata",function(){a.resizeVideo();a.dataIntervalID&&clearInterval(a.dataIntervalID); a.dataIntervalID=setInterval(function(){isNaN(a.videoUp2Js.currentTime)||isNaN(a.videoUp2Js.duration)||a.player_mediaTime.html(a.formatCurrentTime(a.videoUp2Js.currentTime)+a.formatDuration(a.videoUp2Js.duration));if(!a.seekBarDown){a.progress_level.css("width",a.videoUp2Js.currentTime/a.videoUp2Js.duration*a.seekBarSize+"px");try{var c=Math.floor(a.videoUp2Js.buffered.end(0))}catch(e){}c/=Math.floor(a.videoUp2Js.duration);isNaN(c)||a.load_level.css("width",c*a.seekBarSize+"px")}},a.dataInterval); a.videoUp2Js.play();a.videoInited=!0;a.isMobile&&a.initialAutoplay&&(a.autoPlay=!0);a.showControls();a.isIOS&&a._resizeControls();a.fullScreenStatus()&&a.player_fullscreen.children("img").attr("src",a.ic_fullscreen_enter)}).bind("waiting",function(){a.mediaPreloader&&a.mediaPreloader.css("display","block")}).bind("playing",function(){a.mediaPreloader&&a.mediaPreloader.css("display","none")}).bind("play",function(){a.componentWrapper.find(".player_playControl").find("img").attr("src",a.ic_pause);a.bigPlay&& a.bigPlay.css("display","none");a.mediaPlaying=!0}).bind("pause",function(){a.componentWrapper.find(".player_playControl").find("img").attr("src",a.ic_play);a.bigPlay&&a.bigPlay.css("display","block");a.mediaPlaying=!1});this.isIOS&&!this.html5video_inited?(this.videoUp2Js.src=this._mediaPath,this.videoUp2Js.load()):this.isAndroid&&!this.html5video_inited&&(this.videoUp2Js.play(),this.bigPlay&&this.bigPlay.css("display","none"),this.previewPoster&&this.previewPoster.stop().animate({opacity:0},{duration:500, easing:"easeOutSine",complete:function(){a.previewPoster.remove();a.previewPoster=null}}),this.videoInited=!0,this.showControls());this.html5video_inited=!0},_initVimeo:function(){var a=this;this._vimeoInited?this._vimeoPlayer.initVideo(this._mediaPath):(this._vimeoPlayer=e.vimeoPlayer({autoPlay:this.vim_autoPlay,defaultVolume:this.defaultVolume,mediaPath:this._mediaPath,vimeoHolder:this.vimeoHolder,isMobile:this.isMobile,initialAutoplay:this.initialAutoplay}),e(this._vimeoPlayer).bind("ap_VimeoPlayer.VIMEO_READY", function(){}),e(this._vimeoPlayer).bind("ap_VimeoPlayer.VIMEO_PLAY",function(){a.mediaPlaying=!0}),e(this._vimeoPlayer).bind("ap_VimeoPlayer.VIMEO_PAUSE",function(){a.mediaPlaying=!1}),e(this._vimeoPlayer).bind("ap_VimeoPlayer.END_PLAY",function(){a.videoEndAction(a._vimeoPlayer)}),this._vimeoInited=!0)},_initYoutube:function(){var a=this;a._showYT();this._youtubeInited?this._youtubePlayer.initVideo(this._mediaPath):(this._youtubePlayer=e.youtubePlayer({autoPlay:this.yt_autoPlay,defaultVolume:this.defaultVolume, mediaPath:this._mediaPath,youtubeHolder:this.youtubeHolder,youtubeChromeless:this._youtubeChromeless,isMobile:this.isMobile,initialAutoplay:this.initialAutoplay,quality:this.useYoutubeHighestQuality}),e(this._youtubePlayer).bind("ap_YoutubePlayer.FORCE_MAIN_STOP",function(){a._hideYT()}),e(this._youtubePlayer).bind("ap_YoutubePlayer.YT_READY",function(){}),e(this._youtubePlayer).bind("ap_YoutubePlayer.START_PLAY",function(){a.mediaPlaying=!0}),e(this._youtubePlayer).bind("ap_YoutubePlayer.STATE_PLAYING", function(){a.mediaPlaying=!0}),e(this._youtubePlayer).bind("ap_YoutubePlayer.STATE_PAUSED",function(){a.mediaPlaying=!1}),e(this._youtubePlayer).bind("ap_YoutubePlayer.END_PLAY",function(){a.videoEndAction(a._youtubePlayer)}),this._youtubeInited=!0)},videoEndAction:function(a){this.mg_gallery.getSlideshowForcePause()?this.includeVideoInSlideshow?this.mg_gallery.videoEnd():this.videoLoop&&(this.isMobile?this.initialAutoplay&&a.play():this.yt_autoPlay&&a.play()):this.videoLoop&&(this.isMobile?this.initialAutoplay&& a.play():this.yt_autoPlay&&a.play())},_showYT:function(){this.youtubeWrapper.css("left","0px");this.isIE&&this._setYTSizeIE()},_setYTSizeIE:function(){if(this.isIE){var a=this._getPlayerSize("w"),c=this._getPlayerSize("h");this.youtubeHolder.css({width:a+2+"px",height:c+2+"px",left:"-1px",top:"-1px"})}},_hideYT:function(){this.youtubeWrapper.css("left","-10000px")},_getComponentSize:function(a){return"w"==a?"normal"==this.componentSize?this.componentWrapper.width():this.getDocumentWidth():"normal"== this.componentSize?this.componentWrapper.height():this.getDocumentHeight()},_getPlayerSize:function(a){return"w"==a?this.componentWrapper.width():this.componentWrapper.height()},getDocumentWidth:function(){return Math.max(e(window).width(),document.documentElement.clientWidth)},getDocumentHeight:function(){return Math.max(e(window).height(),document.documentElement.clientHeight)},_preventSelect:function(a){e(a).each(function(){e(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none", "user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})},_checkPlayerSize:function(){if(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||!this.componentWrapper)return!1;this.origPlayerSizeSet||(this.origPlayerSizeSet=!0,this.origPlayerW=this.componentWrapper.outerWidth(),this.origPlayerH=this.componentWrapper.outerHeight());var a,c;a=this.origPlayerW+3*this.player_close.width();a>this.componentWrapper.width()?a=this.componentWrapper.width():a<this.componentWrapper.width()&& (a=this.componentWrapper.width()>this.origPlayerW+3*this.player_close.width()?this.origPlayerW+3*this.player_close.width():this.componentWrapper.width());c=this.origPlayerH;c>this.componentWrapper.height()?c=this.componentWrapper.height():c<this.componentWrapper.height()&&(c=this.componentWrapper.height()>this.origPlayerH?this.origPlayerH:this.componentWrapper.height());a-=3*this.player_close.width();this.componentWrapper.css({width:a+"px",marginLeft:-a/2+"px",height:c-10+"px",marginTop:-c/2+"px"})}, _doneResizing:function(){"fullscreen"==this.componentSize&&this.resizeComponent();this._componentWidth=this._getComponentSize("w");this._componentHeight=this._getComponentSize("h");this._mediaType&&("local"==this._mediaType?(this.previewPoster&&this.resizePreview(),this.html5Support&&this.videoInited&&this.resizeComponent(),this._resizeControls()):"youtube"==this._mediaType&&this.isIE&&this._setYTSizeIE())},_resizeControls:function(){var a="normal"==this.componentSize?this.componentWrapper.width(): this._getComponentSize("w");this.playerControls.width(a-this.controlsMediaWidthDiff);this.seekBarSize=this.playerControls.width()-this.controlsSeekbarDiff;this.progress_bg.width(this.seekBarSize);this.player_progress.width(this.seekBarSize+20);if(!this.html5Support){var a=a-this.controlsMediaWidthDiff,c=a-this.controlsSeekbarDiff;this.getFlashMovie(this.flashPreview).pb_resizeControls(a,c)}}};e.fn.videoGallery=function(a){return this.each(function(){e.fn.videoGallery.playMedia=function(){c.playMedia()}; e.fn.videoGallery.pauseMedia=function(){c.pauseMedia()};e.fn.videoGallery.setVolume=function(a){c.setVolume(a)};e.fn.videoGallery.flashResizeControls=function(){c.flashResizeControls()};e.fn.videoGallery.flashMainPreviewOff=function(){c.flashMainPreviewOff()};e.fn.videoGallery.flashVideoPause=function(){c.flashVideoPause()};e.fn.videoGallery.flashVideoResume=function(){c.flashVideoResume()};e.fn.videoGallery.flashVideoEnd=function(){c.flashVideoEnd()};e.fn.videoGallery.flashVideoStart=function(){c.flashVideoStart()}; e.fn.videoGallery.dataUpdateFlash=function(){c.dataUpdateFlash(bl,bt,t,d)};var c=new n(e(this),a);e(this).data("videoGallery",c)})};e.fn.videoGallery.defaults={videoGallerySetupDone:function(){}};e.fn.videoGallery.settings={}})(jQuery);